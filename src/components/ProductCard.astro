---
import { Image } from 'astro:assets';
import Button from './Button.astro';
import {
  isImageMetadata,
  type ImageSource,
  applyBaseUrl,
} from '../utils/image';

interface Props {
  title: string;
  price: string;
  description: string;
  buttonText?: string;
  buttonHref?: string;
  image?: ImageSource;
}

const {
  title,
  price,
  description,
  buttonText = '詳しくはこちら',
  buttonHref,
  image,
} = Astro.props;
---

<li class='c-product-card'>
  {
    image && (
      <div class='c-product-card__image-wrapper'>
        {isImageMetadata(image) ? (
          <Image
            src={image.src}
            alt={image.alt}
            class='c-product-card__image'
            width={image.width || image.src.width}
            height={image.height || image.src.height}
            loading='lazy'
          />
        ) : (
          <img
            src={applyBaseUrl(image.src)}
            alt={image.alt}
            class='c-product-card__image'
            width={image.width || 400}
            height={image.height || 300}
            loading='lazy'
          />
        )}
      </div>
    )
  }
  <div class='c-product-card__content'>
    <header class='c-product-card__header'>
      <h3 class='c-product-card__title'>{title}</h3>
      <div class='c-product-card__price'>
        <span class='c-product-card__price-yen'>&#165;</span>
        <span class='c-product-card__price-value'>{price}</span>
        <span class='c-product-card__price-unit'>(税込)</span>
      </div>
    </header>
    <div class='c-product-card__body'>
      <p class='c-product-card__description'>{description}</p>
      <div class='c-product-card__button-wrapper'>
        <Button href={buttonHref || '#'} text={buttonText} variant='primary' />
      </div>
    </div>
  </div>
</li>
